        <!DOCTYPE html>
        <html>
        <head>
                <meta charset="utf-8">
        <title>SkinnedMesh Class / ThreeD Library / Dart Documentation</title>
        <link rel="stylesheet" type="text/css"
            href="../styles.css">
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800" rel="stylesheet" type="text/css">
        <link rel="shortcut icon" href="../favicon.ico">
        
        </head>
        <body data-library="ThreeD" data-type="SkinnedMesh">
        <div class="page">
        <div class="header">
          <a href="../index.html"><div class="logo"></div></a>
          <a href="../index.html">Dart Documentation</a>
         &rsaquo; <a href="../ThreeD.html">ThreeD</a> &rsaquo; <a href="../ThreeD/SkinnedMesh.html">SkinnedMesh</a>        <div id="search-box">
          <input type="search" name="q" id="q" autocomplete="off"
              class="search-input" placeholder="Search API">
        </div>
        
      </div>
      <div class="drop-down" id="drop-down"></div>
      
        <div class="nav">
        
<h2><div class="icon-library"></div><a href="../CurveUtils.html">CurveUtils</a></h2><h2><div class="icon-library"></div><a href="../FontUtils.html">FontUtils</a></h2><h2><div class="icon-library"></div><a href="../GeometryUtils.html">GeometryUtils</a></h2><h2><div class="icon-library"></div><a href="../ImageUtils.html">ImageUtils</a></h2><h2><div class="icon-library"></div><a href="../SceneUtils.html">SceneUtils</a></h2><h2><div class="icon-library"></div><a href="../ShapeUtils.html">ShapeUtils</a></h2><h2><div class="icon-library"></div><a href="../ThreeD.html">ThreeD</a></h2><ul class="icon">
<li><a href="../ThreeD/AmbientLight.html"><div class="icon-class"></div>AmbientLight</a></li>
<li><a href="../ThreeD/ArcCurve.html"><div class="icon-class"></div>ArcCurve</a></li>
<li><a href="../ThreeD/ArrowHelper.html"><div class="icon-class"></div>ArrowHelper</a></li>
<li><a href="../ThreeD/AxisHelper.html"><div class="icon-class"></div>AxisHelper</a></li>
<li><a href="../ThreeD/Bone.html"><div class="icon-class"></div>Bone</a></li>
<li><a href="../ThreeD/BoundingBox.html"><div class="icon-class"></div>BoundingBox</a></li>
<li><a href="../ThreeD/BoundingSphere.html"><div class="icon-class"></div>BoundingSphere</a></li>
<li><a href="../ThreeD/Buffer.html"><div class="icon-class"></div>Buffer</a></li>
<li><a href="../ThreeD/BufferGeometry.html"><div class="icon-class"></div>BufferGeometry</a></li>
<li><a href="../ThreeD/Camera.html"><div class="icon-class"></div>Camera</a></li>
<li><a href="../ThreeD/CanvasRenderData.html"><div class="icon-class"></div>CanvasRenderData</a></li>
<li><a href="../ThreeD/CanvasRenderer.html"><div class="icon-class"></div>CanvasRenderer</a></li>
<li><a href="../ThreeD/CircleGeometry.html"><div class="icon-class"></div>CircleGeometry</a></li>
<li><a href="../ThreeD/ClosedSplineCurve3.html"><div class="icon-class"></div>ClosedSplineCurve3</a></li>
<li><a href="../ThreeD/Color.html"><div class="icon-class"></div>Color</a></li>
<li><a href="../ThreeD/ConvexGeometry.html"><div class="icon-class"></div>ConvexGeometry</a></li>
<li><a href="../ThreeD/CubeGeomSides.html"><div class="icon-class"></div>CubeGeomSides</a></li>
<li><a href="../ThreeD/CubeGeometry.html"><div class="icon-class"></div>CubeGeometry</a></li>
<li><a href="../ThreeD/CubeReflectionMapping.html"><div class="icon-class"></div>CubeReflectionMapping</a></li>
<li><a href="../ThreeD/CubeRefractionMapping.html"><div class="icon-class"></div>CubeRefractionMapping</a></li>
<li><a href="../ThreeD/CubicBezierCurve.html"><div class="icon-class"></div>CubicBezierCurve</a></li>
<li><a href="../ThreeD/CubicBezierCurve3.html"><div class="icon-class"></div>CubicBezierCurve3</a></li>
<li><a href="../ThreeD/Curve.html"><div class="icon-class"></div>Curve&lt;V&gt;</a></li>
<li><a href="../ThreeD/Curve2D.html"><div class="icon-class"></div>Curve2D</a></li>
<li><a href="../ThreeD/Curve3D.html"><div class="icon-class"></div>Curve3D</a></li>
<li><a href="../ThreeD/CurvePath.html"><div class="icon-class"></div>CurvePath</a></li>
<li><a href="../ThreeD/CylinderGeometry.html"><div class="icon-class"></div>CylinderGeometry</a></li>
<li><a href="../ThreeD/DataTexture.html"><div class="icon-class"></div>DataTexture</a></li>
<li><a href="../ThreeD/DirectionalLight.html"><div class="icon-class"></div>DirectionalLight</a></li>
<li><a href="../ThreeD/EllipseCurve.html"><div class="icon-class"></div>EllipseCurve</a></li>
<li><a href="../ThreeD/EventEmitter.html"><div class="icon-class"></div>EventEmitter</a></li>
<li><a href="../ThreeD/EventEmitterEvent.html"><div class="icon-class"></div>EventEmitterEvent</a></li>
<li><a href="../ThreeD/ExtrudeGeometry.html"><div class="icon-class"></div>ExtrudeGeometry</a></li>
<li><a href="../ThreeD/ExtrudeGeometryWorldUVGenerator.html"><div class="icon-class"></div>ExtrudeGeometryWorldUVGenerator</a></li>
<li><a href="../ThreeD/Face3.html"><div class="icon-class"></div>Face3</a></li>
<li><a href="../ThreeD/Face4.html"><div class="icon-class"></div>Face4</a></li>
<li><a href="../ThreeD/Fog.html"><div class="icon-class"></div>Fog</a></li>
<li><a href="../ThreeD/FogExp2.html"><div class="icon-class"></div>FogExp2</a></li>
<li><a href="../ThreeD/FogLinear.html"><div class="icon-class"></div>FogLinear</a></li>
<li><a href="../ThreeD/Frustum.html"><div class="icon-class"></div>Frustum</a></li>
<li><a href="../ThreeD/Geometry.html"><div class="icon-class"></div>Geometry</a></li>
<li><a href="../ThreeD/IFace3.html"><div class="icon-interface"></div>IFace3</a></li>
<li><a href="../ThreeD/IFace4.html"><div class="icon-interface"></div>IFace4</a></li>
<li><a href="../ThreeD/IMaterial.html"><div class="icon-interface"></div>IMaterial</a></li>
<li><a href="../ThreeD/IParticleMaterial.html"><div class="icon-interface"></div>IParticleMaterial</a></li>
<li><a href="../ThreeD/IRenderableFace3.html"><div class="icon-interface"></div>IRenderableFace3</a></li>
<li><a href="../ThreeD/IRenderableFace4.html"><div class="icon-interface"></div>IRenderableFace4</a></li>
<li><a href="../ThreeD/IRenderableObj.html"><div class="icon-interface"></div>IRenderableObj</a></li>
<li><a href="../ThreeD/ITextureMapMaterial.html"><div class="icon-interface"></div>ITextureMapMaterial</a></li>
<li><a href="../ThreeD/IVector2.html"><div class="icon-interface"></div>IVector2</a></li>
<li><a href="../ThreeD/IVector3.html"><div class="icon-interface"></div>IVector3</a></li>
<li><a href="../ThreeD/IVector4.html"><div class="icon-interface"></div>IVector4</a></li>
<li><a href="../ThreeD/IcosahedronGeometry.html"><div class="icon-class"></div>IcosahedronGeometry</a></li>
<li><a href="../ThreeD/ImageLoader.html"><div class="icon-class"></div>ImageLoader</a></li>
<li><a href="../ThreeD/ImmediateRenderObject.html"><div class="icon-class"></div>ImmediateRenderObject</a></li>
<li><a href="../ThreeD/Intersect.html"><div class="icon-class"></div>Intersect</a></li>
<li><a href="../ThreeD/JSONLoader.html"><div class="icon-class"></div>JSONLoader</a></li>
<li><a href="../ThreeD/LOD.html"><div class="icon-class"></div>LOD</a></li>
<li><a href="../ThreeD/LatheGeometry.html"><div class="icon-class"></div>LatheGeometry</a></li>
<li><a href="../ThreeD/LensFlare.html"><div class="icon-class"></div>LensFlare</a></li>
<li><a href="../ThreeD/Light.html"><div class="icon-class"></div>Light</a></li>
<li><a href="../ThreeD/Line.html"><div class="icon-class"></div>Line</a></li>
<li><a href="../ThreeD/LineBasicMaterial.html"><div class="icon-class"></div>LineBasicMaterial</a></li>
<li><a href="../ThreeD/LineCurve.html"><div class="icon-class"></div>LineCurve</a></li>
<li><a href="../ThreeD/LineCurve3.html"><div class="icon-class"></div>LineCurve3</a></li>
<li><a href="../ThreeD/LoadCompleteCallback.html"><div class="icon-interface"></div>LoadCompleteCallback</a></li>
<li><a href="../ThreeD/LoadProgressCallback.html"><div class="icon-interface"></div>LoadProgressCallback</a></li>
<li><a href="../ThreeD/LoadStartCallback.html"><div class="icon-interface"></div>LoadStartCallback</a></li>
<li><a href="../ThreeD/LoadedCallback.html"><div class="icon-interface"></div>LoadedCallback</a></li>
<li><a href="../ThreeD/Loader.html"><div class="icon-class"></div>Loader</a></li>
<li><a href="../ThreeD/Material.html"><div class="icon-class"></div>Material</a></li>
<li><a href="../ThreeD/Matrix3.html"><div class="icon-class"></div>Matrix3</a></li>
<li><a href="../ThreeD/Matrix4.html"><div class="icon-class"></div>Matrix4</a></li>
<li><a href="../ThreeD/Mesh.html"><div class="icon-class"></div>Mesh</a></li>
<li><a href="../ThreeD/MeshBasicMaterial.html"><div class="icon-class"></div>MeshBasicMaterial</a></li>
<li><a href="../ThreeD/MeshDepthMaterial.html"><div class="icon-class"></div>MeshDepthMaterial</a></li>
<li><a href="../ThreeD/MeshFaceMaterial.html"><div class="icon-class"></div>MeshFaceMaterial</a></li>
<li><a href="../ThreeD/MeshLambertMaterial.html"><div class="icon-class"></div>MeshLambertMaterial</a></li>
<li><a href="../ThreeD/MeshNormalMaterial.html"><div class="icon-class"></div>MeshNormalMaterial</a></li>
<li><a href="../ThreeD/MeshPhongMaterial.html"><div class="icon-class"></div>MeshPhongMaterial</a></li>
<li><a href="../ThreeD/MorphAnimMesh.html"><div class="icon-class"></div>MorphAnimMesh</a></li>
<li><a href="../ThreeD/Object3D.html"><div class="icon-class"></div>Object3D</a></li>
<li><a href="../ThreeD/OctahedronGeometry.html"><div class="icon-class"></div>OctahedronGeometry</a></li>
<li><a href="../ThreeD/OrthographicCamera.html"><div class="icon-class"></div>OrthographicCamera</a></li>
<li><a href="../ThreeD/ParametricGeometry.html"><div class="icon-class"></div>ParametricGeometry</a></li>
<li><a href="../ThreeD/Particle.html"><div class="icon-class"></div>Particle</a></li>
<li><a href="../ThreeD/ParticleBasicMaterial.html"><div class="icon-class"></div>ParticleBasicMaterial</a></li>
<li><a href="../ThreeD/ParticleCanvasMaterial.html"><div class="icon-class"></div>ParticleCanvasMaterial</a></li>
<li><a href="../ThreeD/ParticleCanvasMaterialProgram.html"><div class="icon-interface"></div>ParticleCanvasMaterialProgram</a></li>
<li><a href="../ThreeD/ParticleSystem.html"><div class="icon-class"></div>ParticleSystem</a></li>
<li><a href="../ThreeD/Path.html"><div class="icon-class"></div>Path</a></li>
<li><a href="../ThreeD/PathAction.html"><div class="icon-class"></div>PathAction</a></li>
<li><a href="../ThreeD/PerspectiveCamera.html"><div class="icon-class"></div>PerspectiveCamera</a></li>
<li><a href="../ThreeD/PlaneGeometry.html"><div class="icon-class"></div>PlaneGeometry</a></li>
<li><a href="../ThreeD/PointLight.html"><div class="icon-class"></div>PointLight</a></li>
<li><a href="../ThreeD/PolyhedronGeometry.html"><div class="icon-class"></div>PolyhedronGeometry</a></li>
<li><a href="../ThreeD/PolyhedronGeometryVertex.html"><div class="icon-class"></div>PolyhedronGeometryVertex</a></li>
<li><a href="../ThreeD/Program.html"><div class="icon-class"></div>Program</a></li>
<li><a href="../ThreeD/Projector.html"><div class="icon-class"></div>Projector</a></li>
<li><a href="../ThreeD/ProjectorRenderData.html"><div class="icon-class"></div>ProjectorRenderData</a></li>
<li><a href="../ThreeD/QuadraticBezierCurve.html"><div class="icon-class"></div>QuadraticBezierCurve</a></li>
<li><a href="../ThreeD/QuadraticBezierCurve3.html"><div class="icon-class"></div>QuadraticBezierCurve3</a></li>
<li><a href="../ThreeD/Quaternion.html"><div class="icon-class"></div>Quaternion</a></li>
<li><a href="../ThreeD/Ray.html"><div class="icon-class"></div>Ray</a></li>
<li><a href="../ThreeD/Rectangle.html"><div class="icon-class"></div>Rectangle</a></li>
<li><a href="../ThreeD/RenderInts.html"><div class="icon-class"></div>RenderInts</a></li>
<li><a href="../ThreeD/RenderableFace3.html"><div class="icon-class"></div>RenderableFace3</a></li>
<li><a href="../ThreeD/RenderableFace4.html"><div class="icon-class"></div>RenderableFace4</a></li>
<li><a href="../ThreeD/RenderableLine.html"><div class="icon-class"></div>RenderableLine</a></li>
<li><a href="../ThreeD/RenderableObject.html"><div class="icon-class"></div>RenderableObject</a></li>
<li><a href="../ThreeD/RenderableParticle.html"><div class="icon-class"></div>RenderableParticle</a></li>
<li><a href="../ThreeD/RenderableVertex.html"><div class="icon-class"></div>RenderableVertex</a></li>
<li><a href="../ThreeD/Renderer.html"><div class="icon-class"></div>Renderer</a></li>
<li><a href="../ThreeD/Ribbon.html"><div class="icon-class"></div>Ribbon</a></li>
<li><a href="../ThreeD/Scene.html"><div class="icon-class"></div>Scene</a></li>
<li><a href="../ThreeD/ShaderMaterial.html"><div class="icon-class"></div>ShaderMaterial</a></li>
<li><a href="../ThreeD/Shape.html"><div class="icon-class"></div>Shape</a></li>
<li><div class="icon-class"></div><strong>SkinnedMesh</strong></li>
<li><a href="../ThreeD/SphereGeometry.html"><div class="icon-class"></div>SphereGeometry</a></li>
<li><a href="../ThreeD/SphericalReflectionMapping.html"><div class="icon-class"></div>SphericalReflectionMapping</a></li>
<li><a href="../ThreeD/SphericalRefractionMapping.html"><div class="icon-class"></div>SphericalRefractionMapping</a></li>
<li><a href="../ThreeD/SplineCurve.html"><div class="icon-class"></div>SplineCurve</a></li>
<li><a href="../ThreeD/SplineCurve3.html"><div class="icon-class"></div>SplineCurve3</a></li>
<li><a href="../ThreeD/SpotLight.html"><div class="icon-class"></div>SpotLight</a></li>
<li><a href="../ThreeD/Sprite.html"><div class="icon-class"></div>Sprite</a></li>
<li><a href="../ThreeD/SpriteAlignment.html"><div class="icon-class"></div>SpriteAlignment</a></li>
<li><a href="../ThreeD/TetrahedronGeometry.html"><div class="icon-class"></div>TetrahedronGeometry</a></li>
<li><a href="../ThreeD/TextGeometry.html"><div class="icon-class"></div>TextGeometry</a></li>
<li><a href="../ThreeD/Texture.html"><div class="icon-class"></div>Texture</a></li>
<li><a href="../ThreeD/Three.html"><div class="icon-class"></div>Three</a></li>
<li><a href="../ThreeD/TorusGeometry.html"><div class="icon-class"></div>TorusGeometry</a></li>
<li><a href="../ThreeD/TorusKnotGeometry.html"><div class="icon-class"></div>TorusKnotGeometry</a></li>
<li><a href="../ThreeD/TubeGeometry.html"><div class="icon-class"></div>TubeGeometry</a></li>
<li><a href="../ThreeD/UV.html"><div class="icon-class"></div>UV</a></li>
<li><a href="../ThreeD/UVMapping.html"><div class="icon-class"></div>UVMapping</a></li>
<li><a href="../ThreeD/Uniform.html"><div class="icon-class"></div>Uniform</a></li>
<li><a href="../ThreeD/UniformsUtils.html"><div class="icon-class"></div>UniformsUtils</a></li>
<li><a href="../ThreeD/Vector2.html"><div class="icon-class"></div>Vector2</a></li>
<li><a href="../ThreeD/Vector3.html"><div class="icon-class"></div>Vector3</a></li>
<li><a href="../ThreeD/Vector4.html"><div class="icon-class"></div>Vector4</a></li>
<li><a href="../ThreeD/Vertex.html"><div class="icon-class"></div>Vertex</a></li>
<li><a href="../ThreeD/WebGLCamera.html"><div class="icon-class"></div>WebGLCamera</a></li>
<li><a href="../ThreeD/WebGLGeometry.html"><div class="icon-class"></div>WebGLGeometry</a></li>
<li><a href="../ThreeD/WebGLMaterial.html"><div class="icon-class"></div>WebGLMaterial</a></li>
<li><a href="../ThreeD/WebGLObject.html"><div class="icon-class"></div>WebGLObject</a></li>
<li><a href="../ThreeD/WebGLRenderTarget.html"><div class="icon-class"></div>WebGLRenderTarget</a></li>
<li><a href="../ThreeD/WebGLRenderTargetCube.html"><div class="icon-class"></div>WebGLRenderTargetCube</a></li>
<li><a href="../ThreeD/WebGLRenderer.html"><div class="icon-class"></div>WebGLRenderer</a></li>
<li><a href="../ThreeD/WebGLRendererInfo.html"><div class="icon-class"></div>WebGLRendererInfo</a></li>
<li><a href="../ThreeD/WebGLRendererMemoryInfo.html"><div class="icon-class"></div>WebGLRendererMemoryInfo</a></li>
<li><a href="../ThreeD/WebGLRendererRenderInfo.html"><div class="icon-class"></div>WebGLRendererRenderInfo</a></li>
</ul>
<h2><div class="icon-library"></div><a href="../ThreeMath.html">ThreeMath</a></h2></div>
<div class="content">
        <h2><strong>SkinnedMesh</strong>
          Class
        </h2>
        
<div class="doc">

</div>
<h3>Extends</h3>
<p>
<span class="type-box"><span class="icon-class"></span><a href="../ThreeD/Object3D.html">Object3D</a></span>&nbsp;&gt;&nbsp;<span class="type-box"><span class="icon-class"></span><a href="../ThreeD/Mesh.html">Mesh</a></span>&nbsp;&gt;&nbsp;<span class="type-box"><span class="icon-class"></span><strong>SkinnedMesh</strong></span></p>
<h3>Constructors</h3>
<div class="method"><h4 id="SkinnedMesh">
<span class="show-code">Code</span>
new <strong>SkinnedMesh</strong>(geometry, material, [<a href="http://api.dartlang.org/dart_core/bool.html">bool</a> useVertexTexture = true]) <a class="anchor-link" href="#SkinnedMesh"
              title="Permalink to SkinnedMesh.SkinnedMesh">#</a></h4>
<div class="doc">

<pre class="source">
SkinnedMesh( geometry, material, [this.useVertexTexture = true] )
     : identityMatrix = new Matrix4(),
       bones = [],
       boneMatrices = [],
       super(geometry, material) {
       
   var gbone, bone;
   var p, q, s;

   if ( geometry["bones"] != null ) {

     for( gbone in geometry["bones"]) {

       p = gbone.pos;
       q = gbone.rotq;
       s = gbone.scl;

       bone = addBone();

       bone.name = gbone.name;
       bone.position.set( p[0], p[1], p[2] );
       bone.quaternion.set( q[0], q[1], q[2], q[3] );
       bone.useQuaternion = true;

       if ( s != null ) {

         bone.scale.set( s[0], s[1], s[2] );

       } else {

         bone.scale.set( 1, 1, 1 );

       }

     }

     for ( var b = 0; b &lt; this.bones.length; b ++ ) {

       gbone = geometry["bones"][ b ];
       bone = bones[ b ];

       if ( gbone.parent === -1 ) {

         this.add( bone );

       } else {

         bones[ gbone.parent ].add( bone );

       }

     }

     //

     var nBones = bones.length;

     if ( useVertexTexture ) {

       // layout (1 matrix = 4 pixels)
       //  RGBA RGBA RGBA RGBA (=&gt; column1, column2, column3, column4)
       //  with  8x8  pixel texture max   16 bones  (8 * 8  / 4)
       //     16x16 pixel texture max   64 bones (16 * 16 / 4)
       //     32x32 pixel texture max  256 bones (32 * 32 / 4)
       //     64x64 pixel texture max 1024 bones (64 * 64 / 4)

       var size;

       if ( nBones &gt; 256 )
         size = 64;
       else if ( nBones &gt; 64 )
         size = 32;
       else if ( nBones &gt; 16 )
         size = 16;
       else
         size = 8;

       boneTextureWidth = size;
       boneTextureHeight = size;

       boneMatrices = new Float32Array( boneTextureWidth * boneTextureHeight * 4 ); // 4 floats per RGBA pixel
       boneTexture = new DataTexture( boneMatrices, boneTextureWidth, boneTextureHeight, Three.RGBAFormat, Three.FloatType );
       boneTexture.minFilter = Three.NearestFilter;
       boneTexture.magFilter = Three.NearestFilter;
       boneTexture.generateMipmaps = false;
       boneTexture.flipY = false;

     } else {

       boneMatrices = new Float32Array( 16 * nBones );

     }

     pose();

   }
	}
</pre>
</div>
</div>
<h3>Methods</h3>
<div class="method"><h4 id="addBone">
<span class="show-code">Code</span>
<strong>addBone</strong>([<a href="../ThreeD/Bone.html">Bone</a> bone]) <a class="anchor-link" href="#addBone"
              title="Permalink to SkinnedMesh.addBone">#</a></h4>
<div class="doc">

<pre class="source">
addBone( [Bone bone] ) {

	  if ( bone == null ) {
	    bone = new Bone( this );
	  }

	  bones.add( bone );

	  return bone;

	}
</pre>
</div>
</div>
<div class="method"><h4 id="pose">
<span class="show-code">Code</span>
<strong>pose</strong>() <a class="anchor-link" href="#pose"
              title="Permalink to SkinnedMesh.pose">#</a></h4>
<div class="doc">

<pre class="source">
pose() {

	  updateMatrixWorld( true );

	  var bim, bone;
	  
	  List&lt;Matrix4&gt; boneInverses = [];

	  for ( var b = 0; b &lt; bones.length; b ++ ) {

	    bone = bones[ b ];

	    var inverseMatrix = new Matrix4();
	    inverseMatrix.getInverse( bone.skinMatrix );

	    boneInverses.add( inverseMatrix );

	    bone.skinMatrix.flattenToArrayOffset( boneMatrices, b * 16 );

	  }

	  // project vertices to local

	  if ( geometry["skinVerticesA"] == null ) {

	    geometry["skinVerticesA"] = [];
	    geometry["skinVerticesA"] = [];

	    var orgVertex, vertex;

	    for ( var i = 0; i &lt; geometry.skinIndices.length; i ++ ) {

	      orgVertex = geometry.vertices[ i ];

	      var indexA = geometry.skinIndices[ i ].x;
	      var indexB = geometry.skinIndices[ i ].y;

	      vertex = new Vector3( orgVertex.x, orgVertex.y, orgVertex.z );
	      geometry["skinVerticesA"].add( boneInverses[ indexA ].multiplyVector3( vertex ) );

	      vertex = new Vector3( orgVertex.x, orgVertex.y, orgVertex.z );
	      geometry["skinVerticesA"].add( boneInverses[ indexB ].multiplyVector3( vertex ) );

	      // todo: add more influences

	      // normalize weights

	      if ( geometry.skinWeights[ i ].x + geometry.skinWeights[ i ].y != 1 ) {

	        var len = ( 1.0 - ( geometry.skinWeights[ i ].x + geometry.skinWeights[ i ].y ) ) * 0.5;
	        geometry.skinWeights[ i ].x += len;
	        geometry.skinWeights[ i ].y += len;

	      }

	    }

	  }

	}
</pre>
</div>
</div>
<div class="method"><h4 id="updateMatrixWorld">
<span class="show-code">Code</span>
<strong>updateMatrixWorld</strong>([force = false]) <a class="anchor-link" href="#updateMatrixWorld"
              title="Permalink to SkinnedMesh.updateMatrixWorld">#</a></h4>
<div class="doc">

<pre class="source">
updateMatrixWorld([force = false]) {

	  if(matrixAutoUpdate) updateMatrix();

	  // update matrixWorld

	  if ( matrixWorldNeedsUpdate || force ) {

	    if ( parent != null) {

	      matrixWorld.multiply( parent.matrixWorld, matrix );

	    } else {

	      matrixWorld.copy( matrix );

	    }

	    matrixWorldNeedsUpdate = false;

	    force = true;

	  }

	  // update children
	  children.forEach((child) {

	    if ( child is Bone ) {
	      child.update( identityMatrix, false );
	    } else {
	      child.updateMatrixWorld( true );
	    }

	  });

	  // flatten bone matrices to array

	  var b, bl = this.bones.length,
	      ba = this.bones,
	      bm = this.boneMatrices;

	  for ( b = 0; b &lt; bl; b ++ ) {
	    ba[ b ].skinMatrix.flattenToArrayOffset( bm, b * 16 );

	  }

	  if ( useVertexTexture ) {
	    boneTexture.needsUpdate = true;
	  }

	}
</pre>
</div>
</div>
<h3>Fields</h3>
<div class="field"><h4 id="boneMatrices">
<span class="show-code">Code</span>
<a href="http://api.dartlang.org/dart_core/List.html">List</a>         <strong>boneMatrices</strong> <a class="anchor-link"
            href="#boneMatrices"
            title="Permalink to SkinnedMesh.boneMatrices">#</a>
        </h4>
        <div class="doc">

<pre class="source">
List boneMatrices;
</pre>
</div>
</div>
<div class="field"><h4 id="boneTexture">
<span class="show-code">Code</span>
<a href="../ThreeD/DataTexture.html">DataTexture</a>         <strong>boneTexture</strong> <a class="anchor-link"
            href="#boneTexture"
            title="Permalink to SkinnedMesh.boneTexture">#</a>
        </h4>
        <div class="doc">

<pre class="source">
DataTexture boneTexture;
</pre>
</div>
</div>
<div class="field"><h4 id="boneTextureHeight">
<span class="show-code">Code</span>
<a href="http://api.dartlang.org/dart_core/num.html">num</a>         <strong>boneTextureHeight</strong> <a class="anchor-link"
            href="#boneTextureHeight"
            title="Permalink to SkinnedMesh.boneTextureHeight">#</a>
        </h4>
        <div class="doc">

<pre class="source">
num boneTextureWidth, boneTextureHeight;
</pre>
</div>
</div>
<div class="field"><h4 id="boneTextureWidth">
<span class="show-code">Code</span>
<a href="http://api.dartlang.org/dart_core/num.html">num</a>         <strong>boneTextureWidth</strong> <a class="anchor-link"
            href="#boneTextureWidth"
            title="Permalink to SkinnedMesh.boneTextureWidth">#</a>
        </h4>
        <div class="doc">

<pre class="source">
num boneTextureWidth, boneTextureHeight;
</pre>
</div>
</div>
<div class="field"><h4 id="bones">
<span class="show-code">Code</span>
<a href="http://api.dartlang.org/dart_core/List.html">List</a>         <strong>bones</strong> <a class="anchor-link"
            href="#bones"
            title="Permalink to SkinnedMesh.bones">#</a>
        </h4>
        <div class="doc">

<pre class="source">
List bones;
</pre>
</div>
</div>
<div class="field"><h4 id="identityMatrix">
<span class="show-code">Code</span>
<a href="../ThreeD/Matrix4.html">Matrix4</a>         <strong>identityMatrix</strong> <a class="anchor-link"
            href="#identityMatrix"
            title="Permalink to SkinnedMesh.identityMatrix">#</a>
        </h4>
        <div class="doc">

<pre class="source">
Matrix4 identityMatrix;
</pre>
</div>
</div>
<div class="field"><h4 id="useVertexTexture">
<span class="show-code">Code</span>
<a href="http://api.dartlang.org/dart_core/bool.html">bool</a>         <strong>useVertexTexture</strong> <a class="anchor-link"
            href="#useVertexTexture"
            title="Permalink to SkinnedMesh.useVertexTexture">#</a>
        </h4>
        <div class="doc">

<pre class="source">
bool useVertexTexture;
</pre>
</div>
</div>
        </div>
        <div class="clear"></div>
        </div>
        
        <div class="footer">
          <div>This page was generated at 2012-10-01 16:04:45.064</div>
        </div>
        <script async src="../client-static.js"></script>
        </body></html>
        
